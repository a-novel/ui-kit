{"version":3,"sources":["../../src/contexts/sticky.tsx"],"sourcesContent":["import { ReactNode, RefCallback, createContext, useCallback, useContext, useEffect, useState } from \"react\";\n\nexport interface StickyContextValue {\n  offset: number;\n}\n\nexport const StickyContext = createContext<StickyContextValue>({ offset: 0 });\n\nexport const useSticky = () => {\n  return useContext(StickyContext);\n};\n\nexport type withStickyRendererProps<R extends Element> = {\n  stickyRef: RefCallback<R>;\n};\n\nexport type withStickyProps<R extends Element> = {\n  render: (props: withStickyRendererProps<R>) => ReactNode;\n};\n\nexport const WithSticky = <R extends Element>({ render }: withStickyProps<R>) => {\n  // https://stackoverflow.com/a/60476525/9021186\n  const [elementRect, setElementRect] = useState<DOMRect>();\n  const { offset: parentOffset } = useSticky();\n  const [offset, setOffset] = useState(parentOffset);\n\n  const handleRect = useCallback((node: R) => {\n    setElementRect((node as Element)?.getBoundingClientRect());\n  }, []);\n\n  useEffect(() => {\n    setOffset(parentOffset + (elementRect?.height ?? 0));\n  }, [elementRect?.height, parentOffset]);\n\n  return <StickyContext.Provider value={{ offset }}>{render({ stickyRef: handleRect })}</StickyContext.Provider>;\n};\n"],"names":["createContext","useCallback","useContext","useEffect","useState","StickyContext","offset","useSticky","WithSticky","render","elementRect","setElementRect","parentOffset","setOffset","handleRect","node","getBoundingClientRect","height","Provider","value","stickyRef"],"mappings":"0CAAA,QAAiCA,aAAa,CAAEC,WAAW,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAQ,AAM5G,QAAO,MAAMC,cAAgBL,cAAkC,CAAEM,OAAQ,CAAE,EAAG,AAE9E,QAAO,MAAMC,UAAY,KACvB,OAAOL,WAAWG,cACpB,CAAE,AAUF,QAAO,MAAMG,WAAa,CAAoB,CAAEC,MAAM,CAAsB,IAE1E,KAAM,CAACC,YAAaC,eAAe,CAAGP,WACtC,KAAM,CAAEE,OAAQM,YAAY,CAAE,CAAGL,YACjC,KAAM,CAACD,OAAQO,UAAU,CAAGT,SAASQ,cAErC,MAAME,WAAab,YAAY,AAACc,OAC9BJ,eAAgBI,MAAkBC,wBACpC,EAAG,EAAE,EAELb,UAAU,KACRU,UAAUD,aAAgBF,CAAAA,aAAaO,QAAU,CAAA,EACnD,EAAG,CAACP,aAAaO,OAAQL,aAAa,EAEtC,OAAO,KAACP,cAAca,QAAQ,EAACC,MAAO,CAAEb,MAAO,WAAIG,OAAO,CAAEW,UAAWN,UAAW,IACpF,CAAE"}