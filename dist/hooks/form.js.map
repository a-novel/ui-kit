{"version":3,"sources":["../../src/hooks/form.ts"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\n\n/**\n * <span style=\"color: #32adff;\">Adds a boolean typing status, that stays on for a short while everytime the value\n * is updated.</span>\n *\n * Typing state is held for a certain duration when the value changes, and each new modification resets the typing\n * status.\n *\n * You can control the duration of the typing state with an optional second parameter.\n */\nexport const useTypingState = <T>(initialState: T, holdFor: number = 600): [T, (newState: T) => void, boolean, T] => {\n  const [state, setState] = useState(initialState);\n  const [stableState, setStableState] = useState(initialState);\n  const [isTyping, setIsTyping] = useState(false);\n\n  // Keep a reference to the timer, so we can clear it when the component unmounts.\n  const timer = useRef<NodeJS.Timeout | null>(null);\n\n  const updateState = useCallback(\n    (newState: T) => {\n      // Cancel the previous timer, so we don't set isTyping to false too early.\n      if (timer.current) clearTimeout(timer.current);\n\n      setIsTyping(true);\n      setState(newState);\n\n      // If another update occur during this time, the next call will keep the typing flag to true.\n      timer.current = setTimeout(() => {\n        setStableState(newState);\n        setIsTyping(false);\n      }, holdFor);\n    },\n    [holdFor],\n  );\n\n  // Clear timer on unmount.\n  useEffect(() => {\n    return () => {\n      if (timer.current) clearTimeout(timer.current);\n    };\n  }, []);\n\n  return [state, updateState, isTyping, stableState];\n};\n"],"names":["useCallback","useEffect","useRef","useState","useTypingState","initialState","holdFor","state","setState","stableState","setStableState","isTyping","setIsTyping","timer","updateState","newState","current","clearTimeout","setTimeout"],"mappings":"AAAA,OAASA,WAAW,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAQ,AAWjE,QAAO,MAAMC,eAAiB,CAAIC,aAAiBC,QAAkB,GAAG,IACtE,KAAM,CAACC,MAAOC,SAAS,CAAGL,SAASE,cACnC,KAAM,CAACI,YAAaC,eAAe,CAAGP,SAASE,cAC/C,KAAM,CAACM,SAAUC,YAAY,CAAGT,SAAS,OAGzC,MAAMU,MAAQX,OAA8B,MAE5C,MAAMY,YAAcd,YAClB,AAACe,WAEC,GAAIF,MAAMG,OAAO,CAAEC,aAAaJ,MAAMG,OAAO,EAE7CJ,YAAY,MACZJ,SAASO,SAGTF,CAAAA,MAAMG,OAAO,CAAGE,WAAW,KACzBR,eAAeK,UACfH,YAAY,MACd,EAAGN,QACL,EACA,CAACA,QAAQ,EAIXL,UAAU,KACR,MAAO,KACL,GAAIY,MAAMG,OAAO,CAAEC,aAAaJ,MAAMG,OAAO,CAC/C,CACF,EAAG,EAAE,EAEL,MAAO,CAACT,MAAOO,YAAaH,SAAUF,YAAY,AACpD,CAAE"}